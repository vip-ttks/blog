<!DOCTYPE HTML>
<html>
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=10,IE=9,IE=8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">
<title>C++容易搞错的问题 &#8211; 远道者的博客</title>
<script>
window._deel = {name: '远道者的博客',url: '                     /wp-content/themes/yusi1.0', ajaxpager: '', commenton: 0, roll: [0,0]}
</script>
<link rel='dns-prefetch' href='//libs.baidu.com' />
<link rel='dns-prefetch' href='//s.w.org' />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.2.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.2.1\/svg\/","svgExt":".svg","source":{"concatemoji":"\/wp-includes\/js\/wp-emoji-release.min.js?$version"}};
			!function(a,b,c){function d(a){var b,c,d,e,f=String.fromCharCode;if(!k||!k.fillText)return!1;switch(k.clearRect(0,0,j.width,j.height),k.textBaseline="top",k.font="600 32px Arial",a){case"flag":return k.fillText(f(55356,56826,55356,56819),0,0),!(j.toDataURL().length<3e3)&&(k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57331,65039,8205,55356,57096),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57331,55356,57096),0,0),c=j.toDataURL(),b!==c);case"emoji4":return k.fillText(f(55357,56425,55356,57341,8205,55357,56507),0,0),d=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55357,56425,55356,57341,55357,56507),0,0),e=j.toDataURL(),d!==e}return!1}function e(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i,j=b.createElement("canvas"),k=j.getContext&&j.getContext("2d");for(i=Array("flag","emoji4"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='style-css'  href='/wp-content/themes/yusi1.0/style_28329.css                       ' type='text/css' media='all' />
<script type='text/javascript' src='//libs.baidu.com/jquery/1.8.3/jquery.min.js?ver=1.0'></script>
<script type='text/javascript' src='/wp-content/themes/yusi1.0/js/jquery_28329.js                       '></script>
<link rel='https://api.w.org/' href='                     /wp-json/' />
<link rel='prev' title='rtmp抓包' href='                     /archives/170' />
<link rel='next' title='C++中放弃使用cout只使用printf' href='                     /archives/195' />
<link rel="canonical" href="                     /archives/192" />
<link rel='shortlink' href='/index_32574.html           ' />
<link rel="alternate" type="application/json+oembed" href="/wp-json/oembed/1.0/embed/index_34547.html                                                       " />
<link rel="alternate" type="text/xml+oembed" href="                     /wp-json/oembed/1.0/embed?url=http%3A%2F%2F127.0.0.1%3A8000%2Farchives%2F192&#038;format=xml" />
<script type="text/javascript" src="                     /wp-content/plugins/ueditor/ueditor/third-party/SyntaxHighlighter/shCore.js"></script><link type="text/css" rel="stylesheet" href="                      /wp-content/plugins/ueditor/ueditor/third-party/SyntaxHighlighter/shCoreDefault.css" /><meta name="keywords" content="工作技术">
<meta name="description" content="下面的代码 打印结果int&nbsp;ch[]={0,1,2,3,4,5}; printf(&quot;%d&nbsp;%d&nbsp;%d&nbsp;%d&nbsp;%d\r\n&quot;,ch,&amp;ch,&amp;ch+1,&amp;ch+2,&amp;ch[1]);VS2005下面的打印结果是，当然因为是指针所以每次都会不一样1244932&nbsp;1244932&nbsp;1244956&nbsp;1244980&nb">
<!--[if lt IE 9]><script src="                     /wp-content/themes/yusi1.0/js/html5.js"></script><![endif]-->
</head>
<body class="post-template-default single single-post postid-192 single-format-standard">

<header id="header" class="header">
<div class="container-inner">
 <div class="yusi-logo">
                    <a href="/">
                        <h1>
                                                        <span class="yusi-mono">远道者的博客</span>
                                                        <span class="yusi-bloger">技术文章</span>
                                                    </h1>
                    </a>
    </div>
</div>

	<div id="nav-header" class="navbar">
		
		<ul class="nav">
			<div class="menu"></div>
<li style="float:right;">
                    <div class="toggle-search"><i class="fa fa-search"></i></div>
<div class="search-expand" style="display: none;"><div class="search-expand-inner"><form method="get" class="searchform themeform" onsubmit="location.href='                     /search/' + encodeURIComponent(this.s.value).replace(/%20/g, '+'); return false;" action="/"><div> <input type="ext" class="search" name="s" onblur="if(this.value=='')this.value='search...';" onfocus="if(this.value=='search...')this.value='';" value="search..."></div></form></div></div>
</li>
		</ul>
	</div>
	</div>
</header>
<section class="container"><div class="speedbar">
				<div class="toptip"><strong class="text-success"><i class="fa fa-volume-up"></i> </strong> </div>
	</div>
	<div class="content-wrap">
	<div class="content">

				<header class="article-header">
			<h1 class="article-title"><a href="                     /archives/192">C++容易搞错的问题</a></h1>
			<div class="meta">
				<span id="mute-category" class="muted"><i class="fa fa-list-alt"></i><a href="                     /archives/category/%e5%b7%a5%e4%bd%9c%e6%8a%80%e6%9c%af"> 工作技术</a></span>				<span class="muted"><i class="fa fa-user"></i> <a href="                     /archives/author/admin">admin</a></span>
				<time class="muted"><i class="fa fa-clock-o"></i> 7个月前 (07-17)</time>
				<span class="muted"><i class="fa fa-eye"></i> 23℃</span>
											</div>
		</header>
		<article class="article-content">
			<p>下面的代码 打印结果</p>
<pre class="brush:cpp;toolbar:false">int&nbsp;ch[]={0,1,2,3,4,5};
printf(&quot;%d&nbsp;%d&nbsp;%d&nbsp;%d&nbsp;%d\r\n&quot;,ch,&amp;ch,&amp;ch+1,&amp;ch+2,&amp;ch[1]);</pre>
<p>VS2005下面的打印结果是，当然因为是指针所以每次都会不一样</p>
<pre class="brush:cpp;toolbar:false">1244932&nbsp;1244932&nbsp;1244956&nbsp;1244980&nbsp;1244936</pre>
<p></p>
<p>下面的代码错误在何处</p>
<pre class="brush:cpp;toolbar:false">vector&lt;__int64&gt;&nbsp;demo;
__int64&nbsp;cur=0;
for(int&nbsp;i=0;i&lt;100;i++)
{
	for(int&nbsp;i=0;i&lt;1000;i++)
	{
		demo[cur]=cur++;
	}
	printf(&quot;%p\r\n&quot;,&amp;demo[0]);
}</pre>
<p></p>
<p>下面的代码会输出什么</p>
<pre class="brush:cpp;toolbar:false">DWORD&nbsp;t,t2;
printf(&quot;t=%d&nbsp;t2=%d\r\n&quot;,t,t2);</pre>
<p>实际上debug下回报错，release下输出内容不定</p>
<p></p>
<p>下面的代码会输出什么</p>
<pre class="brush:cpp;toolbar:false">int&nbsp;n=10;
if(n=0)printf(&quot;ok1\r\n&quot;);
else&nbsp;printf(&quot;ok2\r\n&quot;);</pre>
<p>实际上赋值语句作为if的判断条件，应该先运行赋值运算，然后把左值拿来做if的判断条件，并且通常0表示false，非零为true</p>
<p></p>
<p>C++空类的大小，下面输出的值将会是什么</p>
<pre class="brush:cpp;toolbar:false">#include&nbsp;&quot;stdafx.h&quot;

class&nbsp;CDemo
{
};
class&nbsp;CDemo2
{
public:
	void&nbsp;test();
};
class&nbsp;CDemo3
{
public:
	virtual&nbsp;void&nbsp;test();
};

class&nbsp;CDemo4
{
public:
	virtual&nbsp;void&nbsp;test();
};

int&nbsp;_tmain(int&nbsp;argc,&nbsp;_TCHAR*&nbsp;argv[])
{
	printf(&quot;size=%d\r\n&quot;,sizeof(CDemo));
	printf(&quot;size=%d\r\n&quot;,sizeof(CDemo2));
	printf(&quot;size=%d\r\n&quot;,sizeof(CDemo3));
	printf(&quot;size=%d\r\n&quot;,sizeof(CDemo4));
	return&nbsp;0;
}</pre>
<p>应该是1,1,4,4一个类对象的大小等于所以非静态对象的大小加上虚函数列表指针的大小，但是类的大小不能等于0，所以空的类大小是1</p>
<p>下面的代码输出什么内容</p>
<pre class="brush:cpp;toolbar:false">#include&nbsp;&lt;stdio.h&gt;
#include&nbsp;&lt;stdlib.h&gt;
#include&nbsp;&lt;iostream&gt;
using&nbsp;namespace&nbsp;std;
class&nbsp;a
{
public:
	virtual&nbsp;void&nbsp;demo(){};
};
class&nbsp;b:public&nbsp;a
{
public:
	virtual&nbsp;void&nbsp;demob(){};
};
class&nbsp;c:public&nbsp;b
{
public:
	virtual&nbsp;void&nbsp;democ(){};
};
int&nbsp;main()
{
	c&nbsp;nC;
	printf(&quot;sizeof(c)=%d\r\n&quot;,sizeof(c));
	system(&quot;pause&quot;);
	return&nbsp;0;
}</pre>
<p>应该输出4，当然前提是32位系统</p>
<p>内存对齐的宏指令是</p>
<pre class="brush:cpp;toolbar:false">#pragma&nbsp;pack(n)//其中n就是对齐是最小字节可以取值，1,2,4,8等</pre>
<p>关于虚函数表指针的总结如下：</p>
<p>1.对于一个派生类，如果其基类已经有了虚函数表指针，那么派生类自己就不会再有虚函数指针，就算派生类有自己的虚函数也不会有，这个规则适用于多层嵌套</p>
<p>2.排除情况1，有虚函数，那么一个类就肯定有虚函数表指针</p>
<p>3.空类的大小为1，方便寻址，这样一个实例化的对象才能寻址</p>
<p>4.派生类有N个空类时（即基类的大小为1），那么这些空类的总大小 VS2005下面是N-1个字节，Linux下面GCC是0字节，这里没有考虑内存对齐的情况，实际中需要考虑内存对齐</p>
<p></p>
<p>析构函数为什么要定义为虚函数？</p>
<p>因为防止指向派生类对象的基类指针释放的时候，只析构基类，不析构派生类</p>
<p></p>
<p>引用和指针的区别</p>
<ol class=" list-paddingleft-2" style="list-style-type: decimal;">
<li>
<p>引用定义的时候必须初始化，指针不必</p>
</li>
<li>
<p>引用一旦初始化就不能更改引用，只能操作引用的值，所以引用也可以看成常量指针，但是指针出常量指针外，是可以改变的</p>
</li>
<li>
<p>指针有可能是Null指针，但是引用不会引用会空，使用更加安全</p>
</li>
<li>
<p>引用是目标变量的别名，不占用存储空间</p>
</li>
</ol>
<p></p>
<p>数组和指针的区别</p>
<ol class=" list-paddingleft-2" style="list-style-type: decimal;">
<li>
<p>数组是常量指针</p>
</li>
<li>
<p>使用sizeof可以得到数组的字节大小，但是对指针的话只能得到指针自己的大小</p>
</li>
</ol>
<p></p>
<p>函数参数的传递方式？</p>
<ol class=" list-paddingleft-2" style="list-style-type: decimal;">
<li>
<p>值传递</p>
</li>
<li>
<p>指针传递</p>
</li>
<li>
<p>引用传递</p>
</li>
</ol>
<p></p>
<p>内存分配方式</p>
<ol class=" list-paddingleft-2" style="list-style-type: decimal;">
<li>
<p>静态存储区 从静态存储区域分配。内存在程序编译的时候就已经分配好，这块内存在程序的整个运行期间都存在。例如全局变量，static 变量</p>
</li>
<li>
<p>栈 在栈上创建。在执行函数时，函数内局部变量的存储单元都可以在栈上创建，函数执行结束时这些存储单元自动被释放。栈内存分配运算内置于处理器的指令集。</p>
</li>
<li>
<p>堆 由malloc和new分配的</p>
</li>
</ol>
<p></p>
<p>extern &quot;C&quot;的作用</p>
<p>当C++需要调用C的代码时，对C语言的函数声明需要加extern &quot;C&quot;来明确告知编译器需要使用C的代码，因为C++和C的编译规则，如函数命名等规则不一样，所以直接调用编译会出问题，使用了extern &quot;C&quot;就能正确调用了</p>
<p></p>
<p>#error宏的作用 编译器编译到该代码时，输出用户自定义信息，停止编译</p>
<p></p>
<p>宏定义时，表达式和形参都应该用括号括起来</p>
<p></p>
<p>#define和const变量的区别</p>
<p>宏只是简单的进行替换，不暂用内存空间，const有内存空间，所以后者方便调试</p>
<p></p>
<p>static的作用</p>
<ol class=" list-paddingleft-2" style="list-style-type: decimal;">
<li>
<p>作用域 全局变量，或者全局函数表示只能在当前源文件中使用</p>
</li>
<li>
<p>生存范围 可以一直存在，能保留上一次的结果，即在内存中只有一份</p>
</li>
</ol>
<p></p>
<p>类的const成员，引用成员必须在构造函数的初始化列表中初始化</p>
<p></p>
<p>全局变量的初始化，全局变量类的构造函数都会早于main函数执行</p>
<p></p>
<p>浮点类型和0比较</p>
<pre class="brush:cpp;toolbar:false">#include&nbsp;&lt;float.h&gt;
int&nbsp;main()
{
&nbsp;&nbsp;&nbsp;&nbsp;double&nbsp;f=0.001;
&nbsp;&nbsp;&nbsp;&nbsp;if(fabs(f)&lt;DBL_EPSILON)printf(&quot;&nbsp;is&nbsp;zero\r\n&quot;);
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;0;
&nbsp;}</pre>
<p></p>
<p>复杂声明</p>
<p>void * ( * (*fp1)(int))[10];</p>
<p>float (*(* fp2)(int,int,int))(int);</p>
<p>int (* ( * fp3)())[10]();</p>
<p>分别表示什么意思？</p>
<p>【标准答案】 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p>
<p>1.void * ( * (*fp1)(int))[10]; &nbsp; fp1是一个指针，指向一个函数，这个函数的参数为int型，函数的返回值是一个指针，这个指针指向一个数组，这个数组有10个元素，每个元素是一个void*型指针。</p>
<p>2.float (*(* fp2)(int,int,int))(int); &nbsp; fp2是一个指针，指向一个函数，这个函数的参数为3个int型，函数的返回值是一个指针，这个指针指向一个函数，这个函数的参数为int型，函数的返回值是float型。</p>
<p>3.编译会出错</p>
<p></p>
<p>转载请注明：<a href="                    /">远道者的博客</a> &raquo; <a href="                     /archives/192">C++容易搞错的问题</a></p>

      
<div class="article-social">
			<a href="javascript:;" data-action="ding" data-id="192" id="Addlike" class="action"><i class="fa fa-heart-o"></i>喜欢 (<span class="count">0</span>)</a>	
</div>
	</article>	
				<footer class="article-footer">
			</footer>
	<nav class="article-nav">
			<span class="article-nav-prev"><i class="fa fa-angle-double-left"></i> <a href="                     /archives/170" rel="prev">rtmp抓包</a></span>
			<span class="article-nav-next"><a href="                     /archives/195" rel="next">C++中放弃使用cout只使用printf</a>  <i class="fa fa-angle-double-right"></i></span>
		</nav>

		<div class="related_top">
			<div class="related_posts"><ul class="related_img">

	<li class="related_box"  >
		<a href="                     /archives/523" title="libxl读取Excel文件的日期" target="_blank">
		<img src="/wp-content/themes/yusi1.0/timthumb_65164.html                                                                                                           " alt="libxl读取Excel文件的日期" /><br><span class="r_title">libxl读取Excel文件的日期</span></a>
		</li>
	
	<li class="related_box"  >
		<a href="                     /archives/514" title="重定向ffmpeg输出信息" target="_blank">
		<img src="/wp-content/themes/yusi1.0/timthumb_36608.html                                                                                                            " alt="重定向ffmpeg输出信息" /><br><span class="r_title">重定向ffmpeg输出信息</span></a>
		</li>
	
	<li class="related_box"  >
		<a href="                     /archives/512" title="屏蔽ffmpeg命令的所有提示" target="_blank">
		<img src="/wp-content/themes/yusi1.0/timthumb_46223.html                                                                                                           " alt="屏蔽ffmpeg命令的所有提示" /><br><span class="r_title">屏蔽ffmpeg命令的所有提示</span></a>
		</li>
	
	<li class="related_box"  >
		<a href="                     /archives/509" title="忽略SIGPIPE信号" target="_blank">
		<img src="/wp-content/themes/yusi1.0/timthumb_51340.html                                                                                                           " alt="忽略SIGPIPE信号" /><br><span class="r_title">忽略SIGPIPE信号</span></a>
		</li>
	</ul>

<div class="relates">
<ul>
<li><i class="fa fa-minus"></i><a target="_blank" href="                     /archives/523">libxl读取Excel文件的日期</a></li><li><i class="fa fa-minus"></i><a target="_blank" href="                     /archives/514">重定向ffmpeg输出信息</a></li><li><i class="fa fa-minus"></i><a target="_blank" href="                     /archives/512">屏蔽ffmpeg命令的所有提示</a></li><li><i class="fa fa-minus"></i><a target="_blank" href="                     /archives/509">忽略SIGPIPE信号</a></li><li><i class="fa fa-minus"></i><a target="_blank" href="                     /archives/506">VS2010编译CEF3源代码</a></li><li><i class="fa fa-minus"></i><a target="_blank" href="                     /archives/495">GCC内联汇编实例</a></li><li><i class="fa fa-minus"></i><a target="_blank" href="                     /archives/492">C/C++在宏中包含汇编指令</a></li><li><i class="fa fa-minus"></i><a target="_blank" href="                     /archives/489">汇编实例</a></li>
</ul></div></div>		</div>
									</div>
</div>
<aside class="sidebar">	
<div class="widget widget_text"><div class="textwidget"><div class="social">
</div></div></div>

		<div class="widget widget_recent_entries">		<div class="title"><h2>近期文章</h2></div>		<ul>
					<li>
				<a href="                     /archives/523">libxl读取Excel文件的日期</a>
						</li>
					<li>
				<a href="                     /archives/520">WordPress静态化后放到GitHub</a>
						</li>
					<li>
				<a href="                     /archives/514">重定向ffmpeg输出信息</a>
						</li>
					<li>
				<a href="                     /archives/512">屏蔽ffmpeg命令的所有提示</a>
						</li>
					<li>
				<a href="                     /archives/509">忽略SIGPIPE信号</a>
						</li>
				</ul>
		</div>		</aside></section>
<footer class="footer">
    <div class="footer-inner">
        <div class="copyright pull-left">
          <a href="/" title="xie.space">xie.space</a> 版权所有，保留一切权利，联系站长vip@ttks.cc
        </div>
        <div class="trackcode pull-right">
            <script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_1272902413'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s19.cnzz.com/stat.php%3Fid%3D1272902413%26online%3D1%26show%3Dline' type='text/javascript'%3E%3C/script%3E"));</script>        </div>
    </div>
</footer>

<script type="text/javascript">SyntaxHighlighter.all();</script><script type='text/javascript' src='/wp-includes/js/wp-embed_685.min.js                           '></script>
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script></body>
</html>